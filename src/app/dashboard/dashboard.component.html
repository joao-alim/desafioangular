<div class="dashboard-container">
  
  <header class="app-header">
    <button class="hamburger-btn" (click)="toggleMenu()" [class.active]="menuOpen">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <span class="logo-text">FORD</span>
    <a routerLink="/login" class="logout-link">Sair</a>
  </header>

  <nav class="side-menu" [class.open]="menuOpen">
    <div class="menu-header">
      <h3>Menu</h3>
      <button class="close-btn" (click)="toggleMenu()"></button>
    </div>
    <ul class="menu-list">
      <li>
        <a routerLink="/home" (click)="toggleMenu()">
          <i class="icon"></i>
          <span>Home</span>
        </a>
      </li>
      <li>
        <a routerLink="/dashboard" (click)="toggleMenu()">
          <i class="icon"></i>
          <span>Dashboard</span>
        </a>
      </li>
    </ul>
  </nav>

  <div class="overlay" [class.show]="menuOpen" (click)="toggleMenu()"></div>

  <div class="container mt-4">
    <h1 class="text-center text-primary my-4">Dashboard FORD</h1>

    <div class="row mb-5">
      <div class="col-md-3">
        <div class="card p-3">
          <label class="mb-2">Ve铆culo</label>
          <select class="form-select" [ngModel]="selectedVehicle" (ngModelChange)="onVehicleSelect($event)">
            <option [ngValue]="null" disabled>Selecione um modelo</option>
            <option *ngFor="let v of vehicles" [ngValue]="v">{{ v.vehicle }}</option>
          </select>
        </div>
      </div>

      <div class="col-md-3">
        <div class="card p-3 text-center">
          <h5>Total de Vendas</h5>
          <h3 class="text-info">{{ totalSales }}</h3>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-3 text-center">
          <h5>Conectados</h5>
          <h3 class="text-info">{{ connectedVehicles }}</h3>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-3 text-center">
          <h5>Update Software</h5>
          <h3 class="text-info">{{ softwareUpdates }}</h3>
        </div>
      </div>
    </div>

    <div class="row justify-content-center mb-5">
      <div class="col-md-6 text-center">
        <img [src]="vehicleImage" class="img-fluid" alt="Ve铆culo Selecionado" *ngIf="vehicleImage">
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="input-group mb-3">
          <span class="input-group-text">Buscar C贸digo (VIN)</span>
          <input type="text" class="form-control" [formControl]="searchControl" placeholder="Ex: 2FRHDUYS2Y63NHD22454">
        </div>

        <table class="table table-striped table-dark">
          <thead>
            <tr>
              <th>C贸digo (VIN)</th>
              <th>Od么metro</th>
              <th>N铆vel Combust铆vel</th>
              <th>Status</th>
              <th>Lat/Long</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="filteredVehicleData$ | async as vehicleData">
              <td>{{ searchControl.value }}</td>
              <td>{{ vehicleData.odometro }} km</td>
              <td>{{ vehicleData.nivelCombustivel }}%</td>
              <td>
                <span [class]="vehicleData.status === 'on' ? 'badge bg-success' : 'badge bg-danger'">
                  {{ vehicleData.status === 'on' ? 'Ligado' : 'Desligado' }}
                </span>
              </td>
              <td>{{ vehicleData.lat }}, {{ vehicleData.long }}</td>
            </tr>
            <tr *ngIf="!(filteredVehicleData$ | async) && searchControl.value">
              <td colspan="5" class="text-center text-warning">Nenhum ve铆culo encontrado com este VIN.</td>
            </tr>
            <tr *ngIf="!searchControl.value">
              <td colspan="5" class="text-center text-muted">Use o campo acima para buscar um c贸digo de ve铆culo.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</div>
